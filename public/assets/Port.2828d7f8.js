var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,l=(t,s,o)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[s]=o;import{e as n,W as i,a0 as c,g as d,Q as m,P as u,_ as p,a1 as b,r as f,o as v,c as g,b as P,R as $,T as h,U as D,t as y,d as x}from"./vendor.559dc3a1.js";import{h as A}from"./index.36530c03.js";import{a as k}from"./axios.1f9a9e3a.js";const C={name:"Account",setup(){const e=n({tableData:[]}),f=u(),v=()=>{k.get("/vue_api?m=clientinfo").then((t=>{e.tableData=t.map((e=>(e.version="",e)));let s=!0;for(let e=0,o=t.length;e<o;e++){const o=t[e];if(`${o.remoteAddress}:${o.remotePort}`===g.value){s=!1;break}}s&&(g.value="")})).catch((e=>{if(k.isAxiosError(e))A(e);else if(console.error(e),e.response){console.error(e.response.data);const{code:t,message:s}=e.response.data;p.error(`Error: ${t} - ${s}`)}}))};i((()=>{const{proxy:t}=b();t.$socket.onmessage=t=>{const s=JSON.parse(t.data);switch(s.m){case"openclient":case"closeclient":console.log("---- client"),console.log({data:s}),v();break;case"openport":case"closeport":console.log("---- port"),console.log({data:s});const{_id:t,portnum:o,status:r}=s;for(let s=0,a=e.tableData.length;s<a;s++){const a=e.tableData[s];if(`${a.remoteAddress}:${a.remotePort}`===t){a.serialPort=o,a.serialStatus=r;break}}}},v()})),c((()=>{const{proxy:e}=b();delete e.$socket.onmessage}));const g=d({get:()=>f.state.vbClientID,set:e=>f.commit("setVBClientID",{vbClientID:e})});return P=((e,t)=>{for(var s in t||(t={}))r.call(t,s)&&l(e,s,t[s]);if(o)for(var s of o(t))a.call(t,s)&&l(e,s,t[s]);return e})({},m(e)),t(P,s({submitVersion:({remoteAddress:t,remotePort:s})=>{const o=`${t}:${s}`;k.get(`/vue_api?m=version&_id=${o}`).then((t=>{const s=JSON.parse(t);if(console.log(s),s.message){p.error(s.message);for(let t=0,s=e.tableData.length;t<s;t++){const s=e.tableData[t];if(`${s.remoteAddress}:${s.remotePort}`===o){s.version="";break}}}else{for(let t=0,r=e.tableData.length;t<r;t++){const r=e.tableData[t];if(`${r.remoteAddress}:${r.remotePort}`===o){r.version=s.version;break}}p.success("成功獲取版本號")}})).catch((e=>{if(k.isAxiosError(e))A(e);else if(console.error(e),e.response){console.error(e.response.data);const{code:t,message:s}=e.response.data;p.error(`Error: ${t} - ${s}`)}}))},vbClientID:g}));var P}},O=P("div",{class:"card-header"},[P("span",null,"TCP Client")],-1),V={class:"text item"},_=P("span",{class:"client-item-title"},"client address:",-1),j={class:"text item"},S=P("span",{class:"client-item-title"},"Client status:",-1),w=P("div",{class:"card-header"},[P("span",null,"Serial Port")],-1),I={class:"text item"},E=P("span",{class:"client-item-title"},"Port Number:",-1),U={class:"text item"},N=P("span",{class:"client-item-title"},"Port Status:",-1),F=P("div",{class:"card-header"},[P("span",null,"DLL Version")],-1),J=x("獲取版本號");C.render=function(e,t,s,o,r,a){const l=f("el-option"),n=f("el-select"),i=f("el-input"),c=f("el-form-item"),d=f("el-button"),m=f("el-form"),u=f("el-card");return v(),g(h,null,[P(n,{modelValue:o.vbClientID,"onUpdate:modelValue":t[1]||(t[1]=e=>o.vbClientID=e),placeholder:"Select"},{default:$((()=>[(v(!0),g(h,null,D(e.tableData,(e=>(v(),g(l,{key:e.remoteAddress+":"+e.remotePort,label:e.remoteAddress+":"+e.remotePort,value:e.remoteAddress+":"+e.remotePort},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),(v(!0),g(h,null,D(e.tableData,(t=>(v(),g(u,{key:t.remoteAddress+":"+t.remotePort,class:"account-container"},{default:$((()=>[O,P("div",V,[_,P("span",null,y(`${t.remoteAddress}:${t.remotePort}`),1)]),P("div",j,[S,P("span",null,y(t.connected),1)]),w,P("div",I,[E,P("span",null,y(t.serialPort),1)]),P("div",U,[N,P("span",null,y(t.serialStatus),1)]),F,P(m,{model:e.versionForm,rules:e.rules,"label-width":"80px","label-position":"right",class:"demo-ruleForm"},{default:$((()=>[P(c,{label:"版本號:",prop:"version"},{default:$((()=>[P(i,{style:{width:"200px"},modelValue:t.version,"onUpdate:modelValue":e=>t.version=e},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),P(c,null,{default:$((()=>[P(d,{type:"success",onClick:e=>o.submitVersion(t)},{default:$((()=>[J])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["model","rules"])])),_:2},1024)))),128))],64)};export default C;
