var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,n=(a,t,o)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o;import{h as s,e as d,F as i}from"./FileSaver.min.81b7fc4b.js";import{a as c}from"./axios.1f9a9e3a.js";import{e as p,W as u,Q as g,p as m,a as b,r as h,X as f,o as w,c as C,b as P,Y as v,t as x,w as y,d as k}from"./vendor.559dc3a1.js";import"./index.36530c03.js";const D={"全部":"all","通過":"pass","不通過":"unpass"},j={name:"ClockIn",setup(){const e=p({loading:!1,list:[],tableData:[],total:0,currentPage:1,pageSize:10,type:"add",doorOptions:[],radioPass:"全部"});u((()=>{m()}));const m=()=>{e.loading=!0;const a=D[e.radioPass];console.log({pass:a}),c.get(`/clockin/list?pass=${a}`).then((a=>{const t=(e.currentPage-1)*e.pageSize,o=t+e.pageSize;e.list=a,e.total=a.length,e.tableData=a.slice(t,o),e.loading=!1})).catch((e=>{console.error(e)}))},b=e=>s(e).format("YYYY-MM-DD HH:mm:ss");return h=((e,a)=>{for(var t in a||(a={}))l.call(a,t)&&n(e,t,a[t]);if(o)for(var t of o(a))r.call(a,t)&&n(e,t,a[t]);return e})({},g(e)),a(h,t({changePage:a=>{e.currentPage=a,m()},refreshData:m,radioPassChange:()=>{e.currentPage=1,m()},formatTime:b,handleDownload:()=>{const a=s().format("YYYYMMDD_HHmmss"),t=e.list,o=`ClockIn_${a}.xlsx`,l=new d.exports.Workbook,r=l.addWorksheet("ClockIn");r.addRow(["用戶名","姓名","卡號","樓號","單元號","門禁編碼","時間","通過"]),r.getColumn(1).width=24,r.getColumn(2).width=16,r.getColumn(3).width=24,r.getColumn(4).width=18,r.getColumn(5).width=18,r.getColumn(6).width=18,r.getColumn(7).width=24,r.getColumn(8).width=12,r.getRow(1).font={size:12,bold:!0};for(let e=0,n=t.length;e<n;e++){const{username:a,realname:o,cardNo:l,building:n,unit:s,doorNo:d,createdAt:i,pass:c}=t[e],p=b(i),u=c?"是":"否";r.addRow([a,o,l,n,s,d,p,u])}l.xlsx.writeBuffer().then((e=>{i.exports.saveAs(new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),o)})).catch((e=>{console.error(e)}))}}));var h}},O=y();m("data-v-649b4614");const _={class:"header"},z=P("span",{class:"radio-label"},"Filter:",-1),Y=k("導出");b();const S=O(((e,a,t,o,l,r)=>{const n=h("el-radio-button"),s=h("el-radio-group"),d=h("el-button"),i=h("el-table-column"),c=h("el-table"),p=h("el-pagination"),u=h("el-card"),g=f("loading");return w(),C(u,{class:"index-container"},{header:O((()=>[P("div",_,[P("div",null,[z,P(s,{modelValue:e.radioPass,"onUpdate:modelValue":a[1]||(a[1]=a=>e.radioPass=a),size:"small",onChange:o.radioPassChange},{default:O((()=>[P(n,{label:"全部"}),P(n,{label:"通過"}),P(n,{label:"不通過"})])),_:1},8,["modelValue","onChange"])]),P(d,{size:"small",icon:"el-icon-download",onClick:o.handleDownload},{default:O((()=>[Y])),_:1},8,["onClick"])])])),default:O((()=>[v(P(c,{data:e.tableData,"tooltip-effect":"dark",style:{width:"100%"}},{default:O((()=>[P(i,{prop:"username",label:"用戶名"}),P(i,{prop:"realname",label:"姓名"}),P(i,{prop:"cardNo",label:"卡號",width:"200"}),P(i,{prop:"building",label:"樓號",width:"200"}),P(i,{prop:"unit",label:"單元號"}),P(i,{prop:"doorNo",label:"門禁編碼",width:"200"}),P(i,{label:"時間",width:"200"},{default:O((e=>[P("div",null,x(o.formatTime(e.row.createdAt)),1)])),_:1}),P(i,{label:"通過"},{default:O((e=>[P("div",null,x(e.row.pass?"是":"否"),1)])),_:1})])),_:1},8,["data"]),[[g,e.loading]]),P(p,{background:"",layout:"prev, pager, next",total:e.total,"page-size":e.pageSize,"current-page":e.currentPage,onCurrentChange:o.changePage},null,8,["total","page-size","current-page","onCurrentChange"])])),_:1})}));j.render=S,j.__scopeId="data-v-649b4614";export default j;
